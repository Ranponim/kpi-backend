# ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ë° ë¶„ì„ ê³„íš
_Exported on 9/20/2025 at 17:23:53 GMT+9 from Cursor (1.6.35)_

---

**User**

3~6ì¥ì— ëŒ€í•´ì„œ ë¶„ì„í•´ì¤˜. ì´ ì•Œê³ ë¦¬ì¦˜ì€ pegì˜ 'íŒì •' ì•Œê³ ë¦¬ì¦˜ì´ë©°, ìš°ë¦¬ëŠ” choi ì•Œê³ ë¦¬ì¦˜ì´ë¼ê³  ë¶€ë¥´ê³ ìˆì–´.  3GPP KPI pegs 'íŒì •' ì•Œê³ ë¦¬ì¦˜ ê´€ì ìœ¼ë¡œ ìƒì„¸í•˜ê²Œ ë¶„ì„í•´ì¤˜. ìš°ë¦¬ëŠ” ì´ ìƒíƒœì—ì„œ ë” í–¥ìƒì‹œí‚¤ì§€ ì•Šê³ , ì´ ë¬¸ì„œì˜ ì•Œê³ ë¦¬ì¦˜ì„ ê·¸ëŒ€ë¡œ êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ê²ƒì´ ëª©ì ì´ì•¼. ì´ ì•Œê³ ë¦¬ì¦˜ì„ íŒŒì´ì„  ì½”ë“œë¡œ êµ¬í˜„í•  ê²ƒì´ê³  ìš°ë¦¬ì˜ MCP / backend / frontendì— ê²°í•©í•˜ëŠ” ê²ƒì´ ëª©ì ì´ì•¼. ì–´ëŠ ë¶€ë¶„ì—ì„œ êµ¬í˜„í•˜ëŠ”ê²ƒì´  í•©ë¦¬ì ì´ê³  ë‚˜ì¤‘ì— 'íŒì •'ì•Œê³ ë¦¬ì¦˜ì„ êµì²´ í•˜ê±°ë‚˜ 'enhancementë¥¼ ìœ„í•œ ë¦¬í™í† ë§'ì„ ëŒ€ë¹„í•˜ëŠ” ê²ƒê¹Œì§€ ê³ ë ¤í•´ì•¼í•´.

ê¹Šì´ ìƒê°í•´ì„œ ì´ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ ë¶„ì„ í•´ì¤˜. ë‹¨ê³„ì ìœ¼ë¡œ ì–´ëŠ ìœ„ì¹˜ì— êµ¬í˜„í•´ì•¼ í• ì§€ íƒêµ¬í•´ì„œ ì¢…í•© ë¦¬í¬íŠ¸ë¡œ êµ¬ì„±í•´ì„œ ì•Œë ¤ì¤˜. ë³´ê³ ì„œ ê²°ì •í•˜ë„ë¡ í• ê²Œ



---

**Cursor**

ì§€ê¸ˆ `TES.web_Choi.md` 3~6ì¥ì„ í™•ì¸í•˜ê³ , ë ˆí¬ì˜ `peg` ê´€ë ¨ ì„œë¹„ìŠ¤/í…ŒìŠ¤íŠ¸ë¥¼ í•¨ê»˜ ì—´ì–´ ì‹¤ì œ ì ìš© ì§€ì ì„ íŒŒì•…í•˜ê² ìŠµë‹ˆë‹¤. ê³§ë°”ë¡œ ê´€ë ¨ íŒŒì¼ë“¤ì„ ë™ì‹œì— ì½ì–´ ì „ì²´ êµ¬ì¡°ì™€ í†µí•© í¬ì¸íŠ¸ë¥¼ ì¡ê² ìŠµë‹ˆë‹¤.

ë°©ê¸ˆ `TES.web_Choi.md` 3~6ì¥ì„ ì •ë…í•˜ê³ , ë ˆí¬ì˜ `PEGCalculator`/`PEGProcessingService`/ë„ë©”ì¸ ëª¨ë¸ì„ í›‘ì–´ í†µí•© ì§€ì ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì´ì œ â€˜Choi íŒì • ì•Œê³ ë¦¬ì¦˜â€™ì„ 3GPP KPI pegs ê´€ì ì—ì„œ ê·¸ëŒ€ë¡œ êµ¬í˜„Â·ê²°í•©í•˜ëŠ” ì¢…í•© ë³´ê³ ì„œë¥¼ ë“œë¦½ë‹ˆë‹¤.

### ëª©ì ê³¼ ë²”ìœ„
- ëª©ì : ë¬¸ì„œì˜ 3~6ì¥ì„ â€œìˆëŠ” ê·¸ëŒ€ë¡œ(as-is)â€ íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ MCP / backend / frontendì— ê²°í•©.
- ë²”ìœ„:
  - 4ì¥: Abnormal Stats Detecting (PEG ì „ìˆ˜)
  - 5ì¥: Stats Analyzing (Main KPI + Sub KPI ë¬¶ìŒ íŒì •)
  - 6ì¥: Filtering (ìœ íš¨ ì‹œê°„ëŒ€ ì„ ì •)
  - 3ì¥ì€ ê²°ê³¼ UI/ìš”ì•½ í˜•íƒœì— í•´ë‹¹í•˜ë©°, ë°±ì—”ë“œ ì¶œë ¥ êµ¬ì¡°ì™€ í”„ë¡ íŠ¸ ë Œë” ê¸°ì¤€ìœ¼ë¡œ ë°˜ì˜

### í•µì‹¬ ê°œë… ìš”ì•½ (ì•Œê³ ë¦¬ì¦˜ ê·œì¹™ ê·¸ëŒ€ë¡œ)
- **Filtering(6ì¥)**:
  - ìƒ˜í”Œ ì „ì²˜ë¦¬(ì´ì›ƒ ì‹œê° 0 ì²˜ë¦¬, DL/UL í•© 0 ì œì™¸) â†’ Pegë³„ ì¤‘ì•™ê°’ ì‚°ì¶œ â†’ ìƒ˜í”Œ/ì¤‘ì•™ê°’ìœ¼ë¡œ ì •ê·œí™” â†’ ê° Pegì—ì„œ Min_Th â‰¤ 3 â‰¤ Max_Th ì¸ ì‹œê°ë§Œ ì±„íƒ â†’ ëª¨ë“  Pegì— ê³µí†µìœ¼ë¡œ ë‚¨ëŠ” ì‹œê°ë§Œ ìµœì¢… ìœ íš¨ ì‹œê°ìœ¼ë¡œ ì„ íƒ.
  - í•„í„°ë§ ê²°ê³¼ê°€ ì…ë ¥ ëŒ€ë¹„ 50% ì´í•˜ì´ë©´ â€œTES can't filter...â€ ë©”ì‹œì§€ë¥¼ ë‚¨ê¸°ê³  ì „ì²´ ì‹œê° ì±„íƒ.
  - ë³€ìˆ˜: Min_Threshold=0.87, Max_Threshold=1.13, Filter_Ratio=50%.
- **Abnormal Detect(4ì¥)**: ëª¨ë“  í†µê³„(peg) ëŒ€ìƒ. ì…€ ë‹¨ìœ„ íŒì • í›„, â€˜í•´ë‹¹ ì…€ ìˆ˜ â‰¥ Î±0(=2)â€™ì´ë©´ ê²°ê³¼ í‘œì‹œ. ì „ì²´ ì…€ì´ Î±0 ë¯¸ë§Œì´ë©´ ëª¨ë“  ì…€ì´ ë™ì¼ íŒì •ì´ì–´ì•¼ í‘œì‹œ.
  - Range(Analyze/Compare ê³µí†µ): DIMSì˜ [min,max] ë°–
  - New(Compare): ì‹ ê·œ í†µê³„
  - ND(Compare): pre/post í•œìª½ë§Œ ND
  - Zero(Compare): pre/post í•œìª½ë§Œ 0
  - High Delta(Compare): Î´ > Î²3, Î´ = (post-pre)/pre*100
  - ë³€ìˆ˜: Î±0=2, Î±1=10(í‘œ ë‚´ ì •ì˜), Î²3=500
- **Stats Analyze(5ì¥, Main/Sub KPI ë¬¶ìŒ)**:
  - Compare ëª¨ë“œì—ì„œ pre/post ë¶„í¬ë¥¼ ë¹„êµí•´ ê²°ê³¼(OK/POK/NOK/Canâ€™t judge/Low/Medium/High Delta/Improve/Degrade/High Variation) ì‚°ì¶œ
  - Canâ€™t judge: pre/post ë‘˜ ì¤‘ ND í¬í•¨
  - High Variation: CV(pre) ë˜ëŠ” CV(post) > Î²4(=10) ë“±, ND/0 íŠ¹ë¡€ ì‹œ Î´=Â±100% ì²˜ë¦¬ í¬í•¨
  - Degrade/Improve: KPI â€˜positive/negativeâ€™ ì—¬ë¶€ì— ë”°ë¼ min/max ë²”ìœ„ ë¹„êµ
  - Similar/Low/Medium/High Delta: Î²0(=1000) ê²½ê³„ë¡œ Î²1/Î²2 ì ìš© ë°©ì‹ ë¶„ê¸° + ||Î´||<Î²5(=3) ì‹œ Similar
  - ë³€ìˆ˜(5.3): Î²0=1000, Î²1=5, Î²2=10, Î²3=500, Î²4=10, Î²5=3
  - ê²°ê³¼ ìš”ì•½(5.4): Mainê³¼ Sub ê²°ê³¼ ì¡°í•©ìœ¼ë¡œ Final(OK/POK/NOK/Canâ€™t judge) ë° ìš”ì•½ ë¬¸êµ¬ ìƒì„±

### í˜„ ë ˆí¬ êµ¬ì¡°ì™€ ì´ìƒì  êµ¬í˜„ ìœ„ì¹˜
- í•„í„°ë§/íŒì •ì€ â€œì§‘ê³„ì™€ íŒŒìƒê³„ì‚°â€ê³¼ ë³„ë„ ì¸µìœ¼ë¡œ ìœ ì§€í•˜ëŠ” ê²Œ êµì²´ì„±ì— ìœ ë¦¬.
- ê¶Œì¥ ê³„ì¸µ:
  - `services/peg_filtering_service.py` (ì‹ ê·œ) â† 6ì¥ êµ¬í˜„
  - `services/peg_judgement_service.py` (ì‹ ê·œ) â† 4ì¥, 5ì¥ êµ¬í˜„
  - `services/peg_processing_service.py` â† ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ë§Œ ë‹´ë‹¹, ë‹¨ê³„ ì¶”ê°€
  - `models/judgement.py` (ì‹ ê·œ) â† Enum/DTO(íŒì •ê²°ê³¼/ìš”ì•½/ê·¼ê±°) ì •ì˜
  - `config/choi_algorithm.yml` or `.py` (ì‹ ê·œ) â† ìƒìˆ˜/ë©”íƒ€(Î², Î±, Mainâ†”Sub êµ¬ì„±, positive/negative ì§€í‘œí‘œ)
- í†µí•© í¬ì¸íŠ¸(ì¸ìš©):
```98:106:analysis_llm/services/peg_processing_service.py
        # ì²˜ë¦¬ ë‹¨ê³„ ì •ì˜
        self.processing_steps = [
            "data_retrieval",
            "data_validation",
            "aggregation",
            "derived_calculation",
            "result_formatting",
        ]
```
- ì—¬ê¸°ì— `"filtering"`, `"judgement"` ë‹¨ê³„ë¥¼ ì¶”ê°€í•´ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í™•ì¥.

### ë°ì´í„° ìš”ê±´ê³¼ íŒŒì´í”„ë¼ì¸
- ì•Œê³ ë¦¬ì¦˜ì€ â€œìƒ˜í”Œ ë ˆë²¨ ë¶„í¬â€ê°€ í•„ìš”(í‰ê· ë§Œìœ¼ë¡œ ë¶ˆê°€). ì¦‰:
  - ê° Peg, ê° Cell, ê° ê¸°ê°„(pre/post)ì˜ ìƒ˜í”Œ ë°°ì—´(5/15ë¶„ ë‹¨ìœ„)ì´ í•„ìš”
  - í˜„ `PEGProcessingService`ëŠ” í‰ê·  ì¤‘ì‹¬. ì•„ë˜ êµ¬ì¡°ë¡œ í™•ì¥ í•„ìš”:
    - DB ì¡°íšŒ: pre/post ê¸°ê°„ì˜ ì‹œê³„ì—´(raw) + ì…€ ê¸°ì¤€ ê·¸ë£¹í•‘
    - FilteringService: 6ì¥ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ìœ íš¨ ì‹œê° ì¸ë±ìŠ¤ ì§‘í•© ì‚°ì¶œ(ì…€/ì°¸ì¡° Peg êµì§‘í•©)
    - í†µê³„ì¹˜: ìœ íš¨ ì‹œê°ë§Œ ëŒ€ìƒìœ¼ë¡œ í‰ê· /ìµœì†Ÿê°’/ìµœëŒ“ê°’/í‘œì¤€í¸ì°¨/CV ê³„ì‚°
    - JudgementService: 4ì¥, 5ì¥ íŒì • ì‹¤í–‰ â†’ ê²°ê³¼ DTO
- ê¸°ì¡´ ì§‘ê³„/íŒŒìƒì€ ê·¸ëŒ€ë¡œ ìœ ì§€(`PEGCalculator`). íŒì •ì€ ë³„ë„.

### ì„¤ê³„ ì œì•ˆ (êµì²´ ê°€ëŠ¥ì„± ê³ ë ¤: Strategy íŒ¨í„´)
- **ì¸í„°í˜ì´ìŠ¤**
  - `JudgementStrategy`:
    - `judge_abnormal(pegs_timeseries_by_cell, dims_ranges) -> AbnormalSummary`
    - `judge_kpis(main_kpis_by_topic, sub_kpis_by_topic, positivity_map) -> KPIJudgementSummary`
  - `FilteringStrategy`:
    - `select_valid_times(reference_pegs_timeseries_by_cell) -> Dict[cell, Set[timeslot]]`
- **êµ¬í˜„ì²´**
  - `ChoiFiltering(FilteringStrategy)` â† 6ì¥
  - `ChoiJudgement(JudgementStrategy)` â† 4Â·5ì¥
- **ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°**
  - `PEGProcessingService.process_peg_data(...)`ì— í•„í„°ë§/íŒì • ë‹¨ê³„ ì‚½ì…
  - êµì²´ í•„ìš” ì‹œ ì „ëµ ì¸ìŠ¤í„´ìŠ¤ë§Œ DIë¡œ ë°”ê¿” ë¼ì›€

### ë„ë©”ì¸ ëª¨ë¸(ìš”ì•½)
- **Enums**
  - `JudgementType`: OK, POK, NOK, CANT_JUDGE
  - `CompareDetail`: SIMILAR, LOW_DELTA, MEDIUM_DELTA, HIGH_DELTA, IMPROVE, DEGRADE, HIGH_VARIATION, NEW, ND, ZERO, RANGE
- **DTO**
  - `PegSampleSeries`: peg_name, cell_id, pre_samples[], post_samples[]
  - `PegPeriodStats`: mean, min, max, std, cv, nd_ratio, zero_ratio
  - `PegCompareMetrics`: delta_pct(Î´), flags(ND/Zero/â€¦) 
  - `PegCompareDecision`: detail, reason, thresholds_used
  - `MainKPIJudgement`: main_result(JudgementType), sub_results(list), final_result(JudgementType), summary_text
  - `AbnormalDetectSummary`: í•­ëª©ë³„/ì…€ìˆ˜ ì¹´ìš´íŠ¸ì™€ í‘œì‹œ ì—¬ë¶€(Î±0 ê·œì¹™ ë°˜ì˜)

### ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ í•µì‹¬ ë¡œì§ ì„¤ê³„
- **Filtering(6ì¥)**:
  - ì…ë ¥: ì°¸ì¡° Peg ì§‘í•©(í‘œ 6.2), ê° Pegì˜ pre/post ìƒ˜í”Œ(ì‹œê³„ì—´), ìœˆë„ìš° ë‹¨ìœ„ ë™ì¼
  - ì „ì²˜ë¦¬: ì´ì›ƒ(n-1, n+1) 0ì¸ ê²½ìš° n ì œì™¸; DL/UL í•©ê³„ 0 ì œì™¸
  - Pegë³„ ì¤‘ì•™ê°’ M ì‚°ì¶œ â†’ ê° ìƒ˜í”Œ xì— ëŒ€í•´ x/M â†’ 0.87 â‰¤ x/M â‰¤ 1.13 ì¸ íƒ€ì„ìŠ¬ë¡¯ ìœ ì§€
  - Peg êµì§‘í•© íƒ€ì„ìŠ¬ë¡¯ë§Œ ì±„íƒ; ë¹„ìœ¨ì´ 50% ì´í•˜ì´ë©´ ì „ì²´ ì‚¬ìš© + ê²½ê³  ë©”ì‹œì§€
- **Abnormal(4ì¥)**:
  - Compare ì „ì œ
  - Pegë³„/ì…€ë³„ë¡œ Î´, ND/Zero/New/Range íŒì •
  - ì…€ ì¹´ìš´íŠ¸ê°€ Î±0 ì´ìƒì´ë©´ ê²°ê³¼ í‘œì¶œ(ì „ì²´ ì…€<Î±0ì´ë©´ ëª¨ë“  ì…€ ë™ì¼ íŒì • ì¡°ê±´)
- **Analyze(5ì¥)**:
  - ë¶„í¬ ê¸°ë°˜: pre/post ê°ê° min/max/mean/std/cv ì‚°ì¶œ
  - Canâ€™t judge/High Variation ì²˜ë¦¬(Î²4=10), ND/0 íŠ¹ë¡€ Î´=Â±100%
  - Improve/Degrade: positive/negative ë§¤í•‘ í•„ìš”(ì„¤ì •íŒŒì¼)
  - Similar/Low/Medium/High Delta: Î²0 ê²½ê³„ë¡œ Î²1/Î²2 ì ìš©, Î²3 ìƒí•œ, Î²5 ì ˆëŒ€ê°’ ì†Œê·œëª¨ êµ¬ê°„
  - ê²°ê³¼ ìš”ì•½(5.4) ì¡°ë¦½: Main ê²°ê³¼ì— Sub ê²°ê³¼ë¥¼ ê²°í•©í•´ ìµœì¢…/ìš”ì•½ë¬¸ ìƒì„±

### êµ¬ì„±/ìƒìˆ˜(ì½”ë“œ ì™¸ë¶€í™”)
- `config/choi_algorithm.yml` ì˜ˆ:
  - thresholds: Î±0, Î±1, Î²0~Î²5, min_th, max_th, filter_ratio
  - positivity_map: KPI ì´ë¦„ â†’ positive/negative
  - main_kpi_topics: topic â†’ {main: peg, subs: [pegs...]}
  - dims_ranges: peg â†’ {min,max} (Range íŒì •ìš©; ì—†ìœ¼ë©´ Range ìŠ¤í‚µ)
- ìš´ì˜ ì¤‘ ë³€ê²½ ê°€ëŠ¥, ë¦¬ë¡œë“œ ì§€ì›(í•« ë¦¬ë¡œë“œ/ë²„ì „ íƒœê¹… ê¶Œì¥)

### í†µí•© ê³„íš (Backend/MCP/Frontend)
- Backend
  - `PEGProcessingService`ì— 2ë‹¨ê³„ ì¶”ê°€:
    - `"filtering"`: `FilteringStrategy` í˜¸ì¶œ â†’ ìœ íš¨ íƒ€ì„ìŠ¬ë¡¯ ì¸ë±ìŠ¤ ì „ë‹¬
    - `"judgement"`: `JudgementStrategy` í˜¸ì¶œ â†’ Abnormal(4ì¥), KPI(5ì¥) ê²°ê³¼ ìƒì„±
  - ê²°ê³¼ ìŠ¤í‚¤ë§ˆ: 3ì¥ì˜ UIì™€ 5.4 ìš”ì•½ì„ ê·¸ëŒ€ë¡œ ë§Œë“¤ ìˆ˜ ìˆê²Œ JSON êµ¬ì¡° ì •ê·œí™”
  - ë¡œê¹…/ì˜ˆì™¸: í•¨ìˆ˜ ë‹¨ìœ„ INFO/DEBUG, ë‹¨ê³„/ì…ë ¥ ìš”ì•½, ì„ê³„ì¹˜/ì‚¬ìœ (reason) ë°˜ë“œì‹œ í¬í•¨
- MCP
  - íƒœìŠ¤í¬ë¡œ ë¶„ë¦¬: â€œChoi Filteringâ€, â€œChoi Judgementâ€, â€œKPI Topic ì •ì˜â€, â€œpositivity ë§¤í•‘â€ ë“±
  - êµì²´ ëŒ€ë¹„: ë³„ë„ íƒœê·¸ì—ì„œ ëŒ€ì•ˆ ì•Œê³ ë¦¬ì¦˜ ê°œë°œ/í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- Frontend
  - 3ì¥ì˜ ë·°(OK/POK/NOK/Canâ€™t judge, íˆ´íŒìœ¼ë¡œ ê¸°ì¤€ ë…¸ì¶œ, Sub KPI í† ê¸€, POST AVG/Full Screen ë“±)ë¥¼ ì¬í˜„ ê°€ëŠ¥í•œ í•„ë“œ ì œê³µ:
    - ê° ì…€Â·Pegì˜ detail(Î´, CV, ND/Zero/Range/New), ê¸°ì¤€ ë¬¸êµ¬, ì„ê³„ì¹˜
    - Main KPI í–‰: hover ì‹œ íŒì • ê¸°ì¤€/ìˆ˜ì¹˜ í‘œì‹œ
    - Sub KPI ë“œë¦´ë‹¤ìš´: ê° Subì˜ íŒì •/ê·¼ê±°
    - í•„í„°ë§ ë©”ì‹œì§€(50% ì´í•˜ ì‹œ) í‘œê¸°

### í…ŒìŠ¤íŠ¸ ì „ëµ
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
  - Filtering: ê²½ê³„ê°’(0.87/1.13), ì¤‘ì•™ê°’ ë¹„ëŒ€ì¹­, 50% ì„ê³„ ë©”ì‹œì§€
  - Abnormal(4ì¥): ND/Zero/New/Range/High Delta Î´=500+ ì¼€ì´ìŠ¤
  - Analyze(5ì¥): ê° ì„¸ë¶€ ê·œì¹™(positive/negative ì „í™˜, Î²0 ìŠ¤ìœ„ì¹˜, Î²5 ì ˆëŒ€ê°’)
- í†µí•© í…ŒìŠ¤íŠ¸
  - ì‹¤ì œ ìœ ì‚¬ ì‹œê³„ì—´(ì‚¬ì „ ìƒì„±)ë¡œ topicë³„ Main/Sub íŒì • ì¼ì¹˜ ê²€ì¦
  - Î±0 ì¡°ê±´ì— ë”°ë¥¸ ê²°ê³¼ ë…¸ì¶œ ì—¬ë¶€
- íšŒê·€ ê³ ì •
  - ë¬¸ì„œ ì˜ˆì‹œ/ì‚¬ë‚´ í‘œì¤€ ìƒ˜í”Œì„ í”½ìŠ¤ì³ë¡œ ê³ ì •í•´ ìŠ¤ëƒ…ìƒ· ê²€ì¦

### ë¡œê·¸/ì˜ˆì™¸(ìš”êµ¬ì‚¬í•­ ë°˜ì˜)
- ëª¨ë“  ê³µê°œ í•¨ìˆ˜ëŠ” ì‹œì‘/ì…ë ¥ ìš”ì•½/ì¤‘ê°„ ì˜ì‚¬ê²°ì •/ìµœì¢… ê²°ê³¼ ë¡œê·¸ ë‚¨ê¹€
- ì‹¤íŒ¨ ì‹œ ë‹¨ê³„Â·ì„ê³„ì¹˜Â·ì…ë ¥ë¶„í¬ ìš”ì•½ì„ ì˜ˆì™¸ detailë¡œ ì²¨ë¶€
- ìƒ˜í”Œ ìˆ˜ ë¶€ì¡±/ND ê³¼ë‹¤/0 ê³¼ë‹¤ ë“±ì˜ ì§„ë‹¨ íŒíŠ¸ í¬í•¨

### ë§ˆì´ê·¸ë ˆì´ì…˜ ë‹¨ê³„(ì‹¤ì œ ë ˆí¬ ë°˜ì˜ ì‹œ)
- 1) ëª¨ë¸/ì„¤ì • ì¶”ê°€: `models/judgement.py`, `config/choi_algorithm.yml`
- 2) ì„œë¹„ìŠ¤ ì¶”ê°€: `services/peg_filtering_service.py`, `services/peg_judgement_service.py`
- 3) ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜: `PEGProcessingService`ì— `"filtering"`, `"judgement"` ë‹¨ê³„ ì‚½ì…
- 4) ë¦¬í¬ì§€í† ë¦¬ í™•ì¥: ì‹œê³„ì—´ ì¡°íšŒ API ì¶”ê°€(ì…€/peg/ê¸°ê°„ë³„ ìƒ˜í”Œ)
- 5) API ì‘ë‹µ ìŠ¤í‚¤ë§ˆ í™•ì¥: 3ì¥ UIê°€ ê·¸ëŒ€ë¡œ ê·¸ë ¤ì§€ë„ë¡ JSON í˜•íƒœ ì •ê·œí™”
- 6) í…ŒìŠ¤íŠ¸: ë‹¨ìœ„/í†µí•© ì¼€ì´ìŠ¤ ì‘ì„±, ë² ì´ìŠ¤ë¼ì¸ ìŠ¤ëƒ…ìƒ· ê³ ì •

### ì½”ë“œ ê²°í•© í¬ì¸íŠ¸(ì¸ìš©)
- ê²°ê³¼ ì¡°ë¦½ ì´ì „ì— íŒì • ê²°ê³¼ë¥¼ í•©ì¹˜ëŠ” ìœ„ì¹˜:
```361:366:analysis_llm/services/peg_processing_service.py
            # 4ë‹¨ê³„: PEGCalculator ì²˜ë¦¬
            logger.info("4ë‹¨ê³„: PEGCalculator ì²˜ë¦¬")
            processed_df = self._process_with_calculator(n1_df, n_df, peg_config or {})
            
            logger.info("PEG ë°ì´í„° ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš° ì™„ë£Œ: %dí–‰", len(processed_df))
            return processed_df
```
- ì—¬ê¸°ì„œ `processed_df` ì´ì „/ì´í›„ì—:
  - â€œì‹œê³„ì—´ ë¡œë“œ â†’ Filtering â†’ í†µê³„ì¹˜ ì‚°ì¶œ â†’ Judgement â†’ `processed_df`ì™€ ë³‘í•©â€ ìˆœìœ¼ë¡œ í¸ì…
- ë„ë©”ì¸ ìœ í‹¸(ì‹œê³„ì—´â†’í†µê³„ ë³€í™˜ ë“±)ì€ `utils/`ì— ë°°ì¹˜í•´ ì¬ì‚¬ìš©í™” ê¶Œì¥

### ë¦¬ìŠ¤í¬/ì£¼ì˜
- DIMS Range ë¬¸ì„œê°’ ì†ŒìŠ¤ í•„ìš”(ì—†ìœ¼ë©´ Range íŒì •ì€ ì˜µì…”ë„ ì²˜ë¦¬)
- ìƒ˜í”Œ ê°„ê²©/ë™ê¸°í™”(5/15ë¶„) ê°•ì œ í•„ìš”
- positive/negative ë§¤í•‘ê³¼ Mainâ†”Sub í† í”½ êµ¬ì„± ì •í™•ì„±(í‘œ 5.1.x ë°˜ì˜)
- pre/post ìƒ˜í”Œ ìˆ˜ ë¹„ëŒ€ì¹­/ND ë¹„ìœ¨ ë†’ì€ í™˜ê²½ì—ì„œ ì˜ˆì™¸ê²½ë¡œ ì¶©ë¶„íˆ ë¡œê·¸

- - -

- ì ìš© ì œì•ˆ:
  - **ì„œë¹„ìŠ¤ ë¶„ë¦¬(Filtering/Judgement) + ì „ëµ ì¸í„°í˜ì´ìŠ¤ + ì„¤ì • ì™¸ë¶€í™”**ë¡œ â€œê·¸ëŒ€ë¡œ êµ¬í˜„â€í•˜ë©´ì„œë„ êµì²´/ê°œì„ ì— ëŒ€ë¹„.
  - **ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ì€ ê¸°ì¡´ `PEGProcessingService`**ì— ë‹¨ê³„ë¡œë§Œ ì¶”ê°€í•´ ì¹¨ìŠµ ìµœì†Œí™”.
  - **í”„ë¡ íŠ¸ì—”ë“œ**ëŠ” 3ì¥ì˜ ë·° ë¡œì§ì„ ê·¸ëŒ€ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ë°±ì—”ë“œê°€ í’ë¶€í•œ ê·¼ê±° í•„ë“œë¥¼ ì œê³µ.

ìš”ì•½
- 6ì¥ í•„í„°ë§(ì¤‘ì•™ê°’ ì •ê·œí™”/ì„ê³„/êµì§‘í•©/50% ê·œì¹™), 4ì¥ ì´ìƒì¹˜(Î±0/Î´/ND/Zero/New/Range), 5ì¥ ë¹„êµ íŒì •(Î²0~Î²5, CV/Improve/Degrade/Delta ê³„ì¸µ, 5.4 ìš”ì•½)ì„ ì›í˜•ëŒ€ë¡œ êµ¬í˜„.
- ìƒˆë¡œìš´ `FilteringService`/`JudgementService`ì™€ `config/choi_algorithm.yml`ë¡œ ëª¨ë“ˆí™”í•´ êµì²´Â·ê°œì„  ìš©ì´.
- `PEGProcessingService`ì— â€œfilteringâ€/â€œjudgementâ€ ë‹¨ê³„ë§Œ ì¶”ê°€í•˜ëŠ” í˜•íƒœë¡œ ì•ˆì „í•˜ê²Œ ê²°í•©.
- ì‹œê³„ì—´ ë°ì´í„° ì¡°íšŒ/í†µê³„ ì‚°ì¶œì´ í•„ìˆ˜ ì „ì œ. ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸ë¡œ ê·œì¹™ë³„ ê²½ê³„ ê²€ì¦.

```python
        # ì²˜ë¦¬ ë‹¨ê³„ ì •ì˜
        self.processing_steps = [
            "data_retrieval",
            "data_validation",
            "aggregation",
            "derived_calculation",
            "result_formatting",
        ]
```

```python
            # 4ë‹¨ê³„: PEGCalculator ì²˜ë¦¬
            logger.info("4ë‹¨ê³„: PEGCalculator ì²˜ë¦¬")
            processed_df = self._process_with_calculator(n1_df, n_df, peg_config or {})
            
            logger.info("PEG ë°ì´í„° ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš° ì™„ë£Œ: %dí–‰", len(processed_df))
            return processed_df
```

---

**User**

4,5,6 ì¥ì˜ íŒì •ê¸°ì¤€ì—ì„œ ë…¼ë¦¬ì ìœ¼ë¡œ ì–´ê¸‹ë‚œ í•­ëª©ì€ ì—†ì–´? ë‚´ê°€ ì†ìœ¼ë¡œ ì˜®ê¸°ë©´ì„œ ì˜¤ë¥˜ì˜ ê°€ëŠ¥ì„±ì´ ìˆì„ ìˆ˜ ìˆì–´. ë…¼ë¦¬ì ìœ¼ë¡œ ì „ì²´ íë¦„ì— ì–´ê¸‹ë‚˜ì§€ ì•Šê³  kpi íŒì •ì„ ë‚´ë¦´ ìˆ˜ ìˆëŠ”ì§€ ê²€í† í•´ì¤˜

---

**Cursor**

ë°©ê¸ˆ 4Â·5Â·6ì¥ì„ ê¸°ì¤€ìœ¼ë¡œ â€˜íŒì •â€™ ê·œì¹™ì„ ì „ì²´ íë¦„ ê´€ì ì—ì„œ ë…¼ë¦¬ ê²€í† í–ˆìŠµë‹ˆë‹¤. ë¬¸ì„œ ê·¸ëŒ€ë¡œ êµ¬í˜„ ê°€ëŠ¥í•œì§€, ìƒì¶©/ëª¨í˜¸ ì§€ì ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì§šê³  ìˆ˜ì •Â·ë³´ì™„ ê¶Œê³ ì•ˆì„ í•¨ê»˜ ì œì‹œí•©ë‹ˆë‹¤.

### í•µì‹¬ ê·¼ê±° ì¸ìš©
```186:205:c:\Users\aruca\Downloads\TES.web_Choi.md
4. Abnormal Stats Detecting Algorithm
...
4.1. Decision Results
| Analyze | Compare |  |  |
| O | O | Range | Statistics are out of the [min, max] range of the DIMS document. |
| X | O | New | If the statistics are new based on the DIMS document. ... |
| X | O | ND | If only one of â€˜preâ€™ and â€˜postâ€™is ND. |
| X | O | Zero | If only one of â€˜preâ€™ and â€˜postâ€™  is zero. |
| X | O | High Delta | â€™Î´â€™ >â€™Î²3â€™ |
Î´ : (â€˜postâ€™-â€™preâ€™)/pre*100 (%)
```

```652:679:c:\Users\aruca\Downloads\TES.web_Choi.md
5.2. Decision Results
| Result | Criteria | PLM Defect |
| Can't judge | If either or both â€˜preâ€™ and â€˜postâ€™ are ND. | X |
| High Variation | 1.  CV(pre) > Î²4 or CV(post) > Î²4 2. ... ND/0 íŠ¹ë¡€ ì‹œ Î´=Â±100% ... | X |
| Degrade | ... | NOK |
| Improve | ... | NOK |
| Similar | 1. If â€˜preâ€™ < Î²0 or â€˜postâ€™< Î²0 , then Î´ <= Î²2 2. If â€˜preâ€™ >= Î²0 or â€˜postâ€™>=Î²0 , then Î´ <= Î²1 3. ||Î´||<Î²5 | OK |
| Low Delta | (Î²2/Î²1 êµ¬ê°„) | NOK |
| Medium Delta | (2*Î²2/2*Î²1 êµ¬ê°„) | NOK |
| High Delta | Î´ > Î²3 | NOK |
...
Î²0=1000, Î²1=5, Î²2=10, Î²3=500, Î²4=10, Î²5=3
```

```698:706:c:\Users\aruca\Downloads\TES.web_Choi.md
6.1. Algorithm Flow
1) ... 2) median ... 3) Normalize (divide by median) 4) Select only the time with sample values of Min_Th <= "3" <= Max_Th.
5) ... if filtered ratio <= 50%, show message and select entire time interval.
```

```730:735:c:\Users\aruca\Downloads\TES.web_Choi.md
6.3. Variables
Min_Threshold=0.87, Max_Threshold=1.13, Filter_Ratio=50%
```

### ë…¼ë¦¬ ì¼ê´€ì„± ì ê²€ ê²°ê³¼ì™€ ë³´ì™„ ê¶Œê³ 

- ë¬¸ì œ ì—†ìŒ/ì˜ë„ëŒ€ë¡œ ë³´ì„
  - **4ì¥ ì „ì²´ êµ¬ì¡°**: ì…€ ë‹¤ìˆ˜ ì¼ì¹˜(Î±0=2) ì‹œ ê²°ê³¼ í‘œì¶œ, ì „ì²´ ì…€ ìˆ˜ê°€ Î±0 ë¯¸ë§Œì´ë©´ â€œì „ ì…€ ë™ì¼â€ ì¡°ê±´ìœ¼ë¡œ í‘œì¶œ. Compare ì „ìš© í•­ëª©(New/ND/Zero/High Delta) ì •ì˜ ì¼ê´€.
  - **5.2 Delta ê³„ì¸µ(Î²1/Î²2/Î²3) êµ¬ì¡°**: ë‚®ì€ íŠ¸ë˜í”½(Î²0)ì¸ ê²½ìš° ì™„í™” ì„ê³„(Î²2), ë†’ì€ íŠ¸ë˜í”½ì¸ ê²½ìš° ì—„ê²© ì„ê³„(Î²1) â†’ Medium/Highë¡œ í™•ì¥í•˜ëŠ” ê³„ì¸µ êµ¬ì¡° ìì²´ëŠ” íƒ€ë‹¹.
  - **6ì¥ í•„í„°ë§ì˜ ì¤‘ì•™ê°’ ì •ê·œí™”**: Pegë³„ ì¤‘ì•™ê°’ìœ¼ë¡œ ì •ê·œí™” í›„ ì„ê³„ ë²”ìœ„(0.87~1.13) êµì§‘í•© ì±„íƒ, 50% ì´í•˜ ì‹œ ì „ì²´ êµ¬ê°„ ì‚¬ìš© ë©”ì‹œì§€ í‘œì¶œ â†’ ì¼ë°˜ì ì¸ ì•ˆì •êµ¬ê°„ ì¶”ì¶œ ë°©ì‹ê³¼ í•©ë¦¬ì .

- ëª¨ìˆœ/ëª¨í˜¸/ì˜¤íƒ€ë¡œ ë³´ì´ëŠ” ì§€ì 

  - êµ¬ë¬¸/ì˜¤íƒ€ ì˜ì‹¬
    - 6.1 4) â€œMin_Th â‰¤ "3" â‰¤ Max_Thâ€ëŠ” ì •ê·œí™” í›„ ê¸°ì¤€ê°’ì´ 1ì´ì–´ì•¼ ìì—°ìŠ¤ëŸ½ìŠµë‹ˆë‹¤. â€œ3â€ì€ **ì˜¤íƒ€ë¡œ ë³´ì´ë©° â€œ1â€**ì´ ë§ìŠµë‹ˆë‹¤. ìˆ˜ì • ê¶Œê³ : Min_Th â‰¤ normalized â‰¤ Max_Th.

  - ì •ì˜Â·ë³€ìˆ˜ ì‚¬ìš©ì˜ ëª¨í˜¸ì„±
    - 4.2ì— **Î±1=10ì´ í‘œì— ì •ì˜ë§Œ ìˆê³  ì‚¬ìš©ì²˜ê°€ ì—†ìŒ**. ëˆ„ë½ì´ê±°ë‚˜ ë¶ˆí•„ìš” ë³€ìˆ˜ë¡œ ë³´ì…ë‹ˆë‹¤. ì‚¬ìš© ìš©ë„ ëª…ì‹œÂ·ì‚­ì œ ì¤‘ íƒì¼ ê¶Œê³ .
    - 5.2ì—ì„œ **Î²0=1000ê³¼ â€˜pre/postâ€™ ë¹„êµ**ëŠ” KPI ê°’(í¼ì„¼íŠ¸/ìœ¨/ë¹„ìœ¨ ë“±)ì— ì¼ê´„ ì ìš© ì‹œ ë¹„ë…¼ë¦¬ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—…ê³„ ê´€ë¡€ìƒ Î²0ëŠ” â€œìƒ˜í”Œ ìˆ˜/íŠ¸ë˜í”½ëŸ‰(ë¶„ëª¨)â€ì˜ í•˜í•œìœ¼ë¡œ ì“°ì…ë‹ˆë‹¤. í˜„ì¬ í‘œê¸°ëŠ” â€œKPI ê°’â€ê³¼ ë¹„êµí•˜ëŠ” ë¬¸ë§¥ì´ë¼ **ì‹¤ì œ ì˜ë„ëŠ” â€˜ë¶„ëª¨(ì‹œë„/íŒ¨í‚·/ë°”ì´íŠ¸/PRB ë“±) < Î²0â€™**ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. ì •í™•íˆ â€œì–´ë–¤ ê¸°ì¤€ëŸ‰ì„ Î²0ì™€ ë¹„êµí•˜ëŠ”ì§€â€ë¥¼ **KPIë³„ë¡œ ëª…ì‹œ**í•´ì•¼ í˜¼ì„ ì´ ì—†ìŠµë‹ˆë‹¤.
    - 5.2 Similarì˜ 1Â·2ë²ˆ ì¡°ê±´ì´ ëª¨ë‘ â€œorâ€ì„ ì‚¬ìš©í•´, í•œìª½ì€ <Î²0, ë‹¤ë¥¸ìª½ì€ â‰¥Î²0ì¸ ê²½ìš° ë‘ ì¡°ê±´ì´ ë™ì‹œì— ì°¸ì´ ë©ë‹ˆë‹¤. **ì‹¤ë¬´ ì˜ë„ëŠ” â€˜ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ì €íŠ¸ë˜í”½ì´ë©´ ì™„í™” ì„ê³„(Î²2)ë¥¼ ì ìš©â€™**ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. ì¦‰ â€œorâ€ ìì²´ëŠ” ë§ì§€ë§Œ, ì¶©ëŒ ì‹œ **ìš°ì„ ìˆœìœ„(Î²2 ìš°ì„ )**ë¥¼ ëª…ë¬¸í™” ê¶Œê³ .
    - 5.2 Low/Medium Delta êµ¬ê°„ì€ **Î´ ê¸°í˜¸ì— ì ˆëŒ€ê°’ í‘œê¸°ê°€ ì—†ìŒ**. Similarì—ëŠ” ||Î´||ê°€ ìˆê³  Delta ê³„ì¸µì—ëŠ” ì—†ìŒ. ë³´í†µ Delta ê³„ì¸µì€ **ë³€í™”ëŸ‰ í¬ê¸°(|Î´|)** ê¸°ì¤€ì´ë¯€ë¡œ â€œ|Î´|â€ë¡œ ëª…ì‹œ ê¶Œê³ (í•´ì„ ì¼ê´€ì„±).
    - 5.2 High DeltaëŠ” Î²0ë¶„ê¸°ì™€ ë¬´ê´€í•˜ê²Œ â€œÎ´>Î²3â€ë¡œ **ë‘ ì¤„ì´ ë™ì¼ ì¡°ê±´**ì…ë‹ˆë‹¤. ì¤‘ë³µ í‘œê¸°ì´ë©° í•˜ë‚˜ë¡œ í•©ì³ë„ ë¬´ë°©(ì˜¤í•´ ë°©ì§€ ì°¨ì›ì—ì„œ ì •ë¦¬ ê¶Œê³ ).

  - ê·œì¹™ ê°„ ì¶©ëŒ ê°€ëŠ¥ì„±(ìš°ì„ ìˆœìœ„ í•„ìš”)
    - **ND vs High Variation vs Delta**:
      - 5.2 â€œCan't judge: ND ì¡´ì¬â€ì™€ High Variationì˜ 2Â·3í•­(â€œNDì¸ ê²½ìš° Î´=Â±100%ë¡œ ê°„ì£¼â€)ì´ **ë™ì‹œì— ì„±ë¦½** ê°€ëŠ¥. ì´ ê²½ìš° **Can't judge ìš°ì„ **(NDê°€ ìˆìœ¼ë©´ ë‹¤ë¥¸ íŒì • ë°°ì œ)ì„ ëª…ë¬¸í™” ê¶Œê³ .
    - **Improve/Degrade vs Delta ê³„ì¸µ**:
      - min/max ê¸°ë°˜ ë¶„í¬ ë¶„ë¦¬(Degrade/Improve)ì™€ í‰ê·  ê¸°ë°˜ Î´ í¬ê¸°(Deltas)ê°€ **ë™ì‹œì— ì„±ë¦½** ê°€ëŠ¥. ë³´í†µ **ë¶„í¬ ë¶„ë¦¬(Degrade/Improve)ë¥¼ Delta ê³„ì¸µë³´ë‹¤ ìš°ì„  ì ìš©**í•©ë‹ˆë‹¤. ìš°ì„ ìˆœìœ„ í‘œê¸° ê¶Œê³ .
    - **4ì¥ ND/Zero(New)ì™€ 5ì¥ Can't judge/High Variation**:
      - 4ì¥ì€ â€œì´ìƒ í†µê³„ íƒì§€â€ ê²°ê³¼ê°€ **ë³µìˆ˜ êµ¬ë¶„ ë™ì‹œ í‘œì¶œ í—ˆìš©**(ë¬¸êµ¬ë¡œ ëª…ì‹œ). 5ì¥ì€ KPI íŒì •(ìµœì¢…ê²°ê³¼) ë‹¨ì¼í™”ê°€ í•„ìš”. **ì¶œë ¥ ì±„ë„ êµ¬ë¶„**(4ì¥ì€ ëª©ë¡í˜• ë‹¤íƒœê¹…, 5ì¥ì€ ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ë‹¨ì¼ ìµœì¢… íŒì •)ì„ ëª…ì‹œ ê¶Œê³ .

  - ì™¸ë¶€ ì˜ì¡´/ì‹¤í–‰ ì •ì˜
    - **Range**: DIMS [min,max] ì°¸ì¡° í•„ìš”. ëˆ„ë½ ì‹œ Range íŒì • ë¶ˆê°€ â†’ â€œë°ì´í„° ì—†ìŒ ì‹œ Range ìŠ¤í‚µâ€ ë˜ëŠ” â€œN/A ì²˜ë¦¬â€ë¥¼ ëª…ì‹œ ê¶Œê³ .
    - **6ì¥ 5) 50% ì´í•˜ ì‹œ ì „êµ¬ê°„ ì‚¬ìš©**: â€œì „êµ¬ê°„â€ì´ 1)ì—ì„œ ì œì™¸í•œ 0/ë¬´íš¨ ìƒ˜í”Œê¹Œì§€ ë˜ì‚´ë¦¬ëŠ”ì§€ ë¶ˆëª…í™•. ì¼ë°˜ì ìœ¼ë¡œëŠ” **ë¬´íš¨ê°’ ì œì™¸ëŠ” ìœ ì§€í•˜ê³  ì •ê·œí™” ì„ê³„(0.87~1.13)ë§Œ í•´ì œ**ê°€ ì•ˆì „í•©ë‹ˆë‹¤. ì˜ë„ ëª…ì‹œ ê¶Œê³ .
    - **ì •ê·œí™” ë¶„ëª¨(ì¤‘ì•™ê°’) = 0**ì¸ ê²½ìš° ì²˜ë¦¬ ê·œì¹™ ëˆ„ë½. 0 ë¶„ëª¨ ë°©ì§€/ìƒ˜í”Œ ì œì™¸/ëŒ€ì²´ê°’ ì§€ì • ì¤‘ í•˜ë‚˜ë¥¼ ëª…ì‹œ ê¶Œê³ .

- í‘œì‹œ/ìš”ì•½ì˜ ì¼ê´€ì„±
  - 5.4 Final Summary ì¡°í•©ì€ í•©ë¦¬ì . ë‹¤ë§Œ **í‘œì‹œ ìˆœì„œ/ìš°ì„ ìˆœìœ„**ë¥¼ ë¬¸ì¥ìœ¼ë¡œ ëª…ì‹œ ê¶Œì¥(ì˜ˆ: Can't judge > High Variation > Improve/Degrade > Delta ê³„ì¸µ > Similar).
  - 3.3(OK/POK/NOK/Can't judge) íˆ´íŒÂ·ì„¸ë¶€ í‘œì‹œ ê¸°ì¤€ì€ 5.2 ì„ê³„/ì‚¬ìœ ë¥¼ ê·¸ëŒ€ë¡œ ë…¸ì¶œí•˜ë©´ ì¼ê´€ì„± ìœ ì§€.

### ì¢…í•© íŒë‹¨
- **í° í‹€ì˜ ë…¼ë¦¬ëŠ” íƒ€ë‹¹**í•˜ë©°, ë¬¸ì„œ ê¸°ì¤€ìœ¼ë¡œ KPI íŒì • êµ¬í˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
- ë‹¤ë§Œ ì•„ë˜ 5ê°€ì§€ëŠ” êµ¬í˜„ ì „ ì •ì •/ëª…ë¬¸í™”ê°€ ê°•ë ¥ ê¶Œê³ ë©ë‹ˆë‹¤.
  1) 6.1 ì •ê·œí™” ì„ê³„ â€œ3â€ â†’ â€œ1â€ë¡œ ìˆ˜ì •  
  2) 5.2 Î²0 ë¹„êµ ëŒ€ìƒì˜ ëª…í™•í™”(â€œKPI ê°’â€ì´ ì•„ë‹Œ â€œë¶„ëª¨/íŠ¸ë˜í”½ëŸ‰/ìƒ˜í”Œìˆ˜â€ ë“±ìœ¼ë¡œ KPIë³„ êµ¬ì²´í™”)  
  3) 5.2 Delta ê³„ì¸µì— |Î´| ì‚¬ìš©ì„ ëª…ì‹œ(ìœ ì‚¬/Delta ì „ë¶€ ì ˆëŒ€ê°’ ê¸°ì¤€ í†µì¼)  
  4) ND/Zero/High Variation/Delta/Improve/Degrade **ìš°ì„ ìˆœìœ„ ê·œì¹™ ëª…ì‹œ**  
  5) 6ì¥ 50% ê·œì¹™ ì‹œ â€œë¬´íš¨ê°’ ì œì™¸ëŠ” ìœ ì§€, ì •ê·œí™” ì„ê³„ë§Œ í•´ì œâ€ë¡œ ë™ì‘ ì •ì˜

ì›ë¬¸ì„ ê·¸ëŒ€ë¡œ ìµœëŒ€í•œ ì¡´ì¤‘í•˜ë©´ì„œ ìœ„ í•­ëª©ë§Œ ë³´ì™„í•˜ë©´, ë°±ì—”ë“œ/í”„ë¡ íŠ¸ ì¼ê´€ì„±ê³¼ ìš´ì˜ ì•ˆì •ì„±ì„ í•¨ê»˜ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì§€ê¸ˆë¶€í„°ëŠ” ìœ„ ê¶Œê³ ëŒ€ë¡œ ë¬¸ì„œì˜ í‘œí˜„ë§Œ ë³´ì™„í•œ â€œëª…í™•íŒ ë²„ì „â€ì„ ê°„ë‹¨ ìš”ì•½í•´ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•„ìš”í•˜ì‹œë©´ ì •ë¦¬ë³¸(í‘œ/ë¬¸ì¥) ë§Œë“¤ì–´ ë“œë¦´ê²Œìš”.

ìš”ì•½
- ì¹˜ëª…ì  ëª¨ìˆœì€ ì—†ê³  êµ¬í˜„ ê°€ëŠ¥.  
- ì˜¤íƒ€(6.1ì˜ "3"â†’"1"), Î²0ì˜ ë¹„êµ ëŒ€ìƒ(ê°’ vs ë¶„ëª¨) ëª¨í˜¸, Deltaì˜ |Î´| í‘œê¸° ë¶ˆì¼ì¹˜, ì¤‘ë³µ/ìš°ì„ ìˆœìœ„ ë¶€ì¬ ë“± ì‹¤ë¬´ êµ¬í˜„ ì‹œ í˜¼ì„  ìœ ë°œ ì§€ì  ì¡´ì¬.  
- NDê°€ ìˆìœ¼ë©´ Can't judge ìš°ì„ , Improve/Degradeê°€ Deltaë³´ë‹¤ ìš°ì„  ë“± ìš°ì„ ìˆœìœ„ ëª…ì‹œ ê¶Œê³ .  
- í•„í„°ë§ 50% ê·œì¹™ê³¼ ë¶„ëª¨=0 ì²˜ë¦¬ ê·œì¹™ì„ ëª…ë¬¸í™” ê¶Œê³ .

```plaintext
4. Abnormal Stats Detecting Algorithm
...
4.1. Decision Results
| Analyze | Compare |  |  |
| O | O | Range | Statistics are out of the [min, max] range of the DIMS document. |
| X | O | New | If the statistics are new based on the DIMS document. ... |
| X | O | ND | If only one of â€˜preâ€™ and â€˜postâ€™is ND. |
| X | O | Zero | If only one of â€˜preâ€™ and â€˜postâ€™  is zero. |
| X | O | High Delta | â€™Î´â€™ >â€™Î²3â€™ |
Î´ : (â€˜postâ€™-â€™preâ€™)/pre*100 (%)
```

```plaintext
5.2. Decision Results
| Result | Criteria | PLM Defect |
| Can't judge | If either or both â€˜preâ€™ and â€˜postâ€™ are ND. | X |
| High Variation | 1.  CV(pre) > Î²4 or CV(post) > Î²4 2. ... ND/0 íŠ¹ë¡€ ì‹œ Î´=Â±100% ... | X |
| Degrade | ... | NOK |
| Improve | ... | NOK |
| Similar | 1. If â€˜preâ€™ < Î²0 or â€˜postâ€™< Î²0 , then Î´ <= Î²2 2. If â€˜preâ€™ >= Î²0 or â€˜postâ€™>=Î²0 , then Î´ <= Î²1 3. ||Î´||<Î²5 | OK |
| Low Delta | (Î²2/Î²1 êµ¬ê°„) | NOK |
| Medium Delta | (2*Î²2/2*Î²1 êµ¬ê°„) | NOK |
| High Delta | Î´ > Î²3 | NOK |
...
Î²0=1000, Î²1=5, Î²2=10, Î²3=500, Î²4=10, Î²5=3
```

```plaintext
6.1. Algorithm Flow
1) ... 2) median ... 3) Normalize (divide by median) 4) Select only the time with sample values of Min_Th <= "3" <= Max_Th.
5) ... if filtered ratio <= 50%, show message and select entire time interval.
```

```plaintext
6.3. Variables
Min_Threshold=0.87, Max_Threshold=1.13, Filter_Ratio=50%
```

---

**User**

MCP, ë°±ì—”ë“œ, í”„ë¡ íŠ¸ì—”ë“œì— ë‚˜ëˆ ì„œ êµ¬í˜„í•˜ëŠ”ê²Œ ê°€ì¥ ì ì ˆí•œê°€?

---

**Cursor**

**ê²°ë¡ : ë°±ì—”ë“œ ì¤‘ì‹¬ êµ¬í˜„ì´ ê°€ì¥ ì ì ˆí•©ë‹ˆë‹¤.**

í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡°ì™€ Choi ì•Œê³ ë¦¬ì¦˜ì˜ íŠ¹ì„±ì„ ì¢…í•© ë¶„ì„í•œ ê²°ê³¼, **MCP/ë°±ì—”ë“œ/í”„ë¡ íŠ¸ì—”ë“œ 3ë¶„í• ë³´ë‹¤ëŠ” ë°±ì—”ë“œ ì¤‘ì‹¬ êµ¬í˜„**ì„ ê°•ë ¥ ê¶Œì¥í•©ë‹ˆë‹¤.

### ê¶Œì¥ ì•„í‚¤í…ì²˜: ë°±ì—”ë“œ ì¤‘ì‹¬ + MCP ë³´ì¡°

**ğŸ¯ í•µì‹¬ êµ¬í˜„ ìœ„ì¹˜**
- **ë°±ì—”ë“œ (analysis_llm)**: 6ì¥, 4ì¥, 5ì¥ ì•Œê³ ë¦¬ì¦˜ **ì „ì²´ êµ¬í˜„**
- **MCP**: ê²°ê³¼ **í•´ì„ ë° ì„¤ëª…** ì§€ì›  
- **í”„ë¡ íŠ¸ì—”ë“œ**: **ìˆœìˆ˜ UI ë Œë”ë§**

### ê° ê³„ì¸µë³„ ì—­í•  ë¶„ë‹´

**ğŸ“Š ë°±ì—”ë“œ (analysis_llm) - í•µì‹¬ ì—”ì§„**
```python
# ì‹ ê·œ ì¶”ê°€ ì„œë¹„ìŠ¤ë“¤
services/
â”œâ”€â”€ choi_filtering_service.py      # 6ì¥: í•„í„°ë§ ì•Œê³ ë¦¬ì¦˜
â”œâ”€â”€ choi_judgement_service.py      # 4ì¥, 5ì¥: ì´ìƒíƒì§€ + KPI íŒì •
â””â”€â”€ peg_processing_service.py      # ê¸°ì¡´: ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í™•ì¥

# ì„¤ì • ì™¸ë¶€í™”
config/
â””â”€â”€ choi_algorithm.yml             # Î±, Î² ìƒìˆ˜ + KPI ì •ì˜
```

**ğŸ¤– MCP - í•´ì„ ì§€ì›**
- ìµœì¢… íŒì • ê²°ê³¼ì— ëŒ€í•œ **ìì—°ì–´ ì„¤ëª…** ìƒì„±
- "ì™œ ì´ KPIê°€ NOKì¸ì§€" **ê·¼ê±° ì„¤ëª…**
- ì‚¬ìš©ì ì§ˆì˜ì‘ë‹µ: "ì´ ë³€í™”ê°€ ì •ìƒì¸ê°€ìš”?"
- **íŠ¸ë Œë“œ ë¶„ì„** ë³´ì¡°

**ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ - UI ë Œë”ë§**
- 3ì¥ í˜•íƒœë¡œ **OK/POK/NOK/Can't judge í‘œì‹œ**
- **íˆ´íŒ**ìœ¼ë¡œ íŒì • ê·¼ê±° í‘œì‹œ (Î²ê°’, ì„ê³„ì¹˜ ë“±)
- **Sub KPI ë“œë¦´ë‹¤ìš´**, í•„í„°ë§ UI
- **Full Screen** ëª¨ë“œ, í†µê³„ ê·¸ë˜í”„

### ì™œ ì´ êµ¬ì¡°ê°€ ìµœì ì¸ê°€?

**âœ… ì¥ì ë“¤**
1. **ì„±ëŠ¥ ìµœì í™”**: ê³„ì‚° ì§‘ì•½ì  ì‘ì—…(í•„í„°ë§, í†µê³„)ì„ ë°±ì—”ë“œì—ì„œ ì¼ê´„ ì²˜ë¦¬
2. **ì¼ê´€ì„± ë³´ì¥**: ë‹¨ì¼ ì‹œìŠ¤í…œ ë‚´ ìƒíƒœ ê´€ë¦¬, ë²„ì „ ë™ê¸°í™” ìš©ì´
3. **ë””ë²„ê¹… í¸ì˜**: ì—ëŸ¬ ì¶”ì ì´ ì£¼ë¡œ ë°±ì—”ë“œ ë‚´ì—ì„œ ì™„ê²°
4. **êµì²´ ìš©ì´ì„±**: Strategy íŒ¨í„´ìœ¼ë¡œ ì•Œê³ ë¦¬ì¦˜ êµì²´ ì‹œ ë°±ì—”ë“œ ë‚´ ì„œë¹„ìŠ¤ë§Œ ë³€ê²½
5. **AI í™œìš©**: MCPê°€ ê·œì¹™ ì ìš©ì´ ì•„ë‹Œ **ê²°ê³¼ í•´ì„**ì— ì§‘ì¤‘ â†’ ë” í° ê°€ì¹˜ ì°½ì¶œ

**âŒ 3ë¶„í• ì˜ ë¬¸ì œì ë“¤**
- **ë³µì¡ì„± í­ì¦**: ê³„ì¸µ ê°„ ë°ì´í„° ì „ë‹¬, ìƒíƒœ ë™ê¸°í™”
- **ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ**: ë„¤íŠ¸ì›Œí¬ í†µì‹ , ì§ë ¬í™” ë¹„ìš©
- **ì¼ê´€ì„± ë¦¬ìŠ¤í¬**: ê° ê³„ì¸µ ë²„ì „ ë¶ˆì¼ì¹˜ ì‹œ íŒì • ì˜¤ë¥˜
- **ë””ë²„ê¹… ì–´ë ¤ì›€**: ì—ëŸ¬ê°€ ì—¬ëŸ¬ ì‹œìŠ¤í…œì— ê±¸ì³ ë°œìƒ

### êµ¬ì²´ì  êµ¬í˜„ í”Œëœ

**1ë‹¨ê³„: ë°±ì—”ë“œ í™•ì¥**
```python
# PEGProcessingServiceì— ë‹¨ê³„ ì¶”ê°€
self.processing_steps = [
    "data_retrieval",
    "data_validation", 
    "filtering",           # ì‹ ê·œ: 6ì¥ êµ¬í˜„
    "aggregation",
    "derived_calculation",
    "judgement",           # ì‹ ê·œ: 4ì¥, 5ì¥ êµ¬í˜„
    "result_formatting",
]
```

**2ë‹¨ê³„: MCP ì—°ë™**
- ë°±ì—”ë“œ íŒì • ê²°ê³¼ë¥¼ ë°›ì•„ ìì—°ì–´ ì„¤ëª… ìƒì„±
- ì‚¬ìš©ì ì§ˆì˜ ì‹œ íŒì • ê·¼ê±° ì„¤ëª…

**3ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œ ë Œë”ë§**
- ë°±ì—”ë“œì—ì„œ ë°›ì€ í’ë¶€í•œ íŒì • ë°ì´í„°ë¥¼ 3ì¥ UIë¡œ í‘œí˜„
- íˆ´íŒ, ë“œë¦´ë‹¤ìš´ ë“± ì¸í„°ë™ì…˜ êµ¬í˜„

### ì˜ˆìƒ ë°ì´í„° í”Œë¡œìš°

```
ì›ì‹œ ë°ì´í„° â†’ [ë°±ì—”ë“œ] â†’ íŒì • ê²°ê³¼ + ê·¼ê±° â†’ [MCP] â†’ ìì—°ì–´ ì„¤ëª… â†’ [í”„ë¡ íŠ¸] â†’ UI ë Œë”ë§
            í•„í„°ë§â†’ì§‘ê³„â†’íŒì •              í•´ì„ ìƒì„±              í‘œì‹œ+ìƒí˜¸ì‘ìš©
```

**ê²°ë¡ **: Choi ì•Œê³ ë¦¬ì¦˜ì€ **ëª…í™•í•œ ìˆ˜í•™ì  ê·œì¹™**ì´ë¯€ë¡œ ë°±ì—”ë“œê°€ ë‹´ë‹¹í•˜ê³ , AIëŠ” **ê²°ê³¼ í•´ì„**ì— ì§‘ì¤‘í•˜ëŠ” ê²ƒì´ ê° ê¸°ìˆ ì˜ ì¥ì ì„ ìµœëŒ€í•œ í™œìš©í•˜ëŠ” ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤. ì„±ëŠ¥, ì•ˆì •ì„±, ìœ ì§€ë³´ìˆ˜ì„±ì„ ëª¨ë‘ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# ì‹ ê·œ ì¶”ê°€ ì„œë¹„ìŠ¤ë“¤
services/
â”œâ”€â”€ choi_filtering_service.py      # 6ì¥: í•„í„°ë§ ì•Œê³ ë¦¬ì¦˜
â”œâ”€â”€ choi_judgement_service.py      # 4ì¥, 5ì¥: ì´ìƒíƒì§€ + KPI íŒì •
â””â”€â”€ peg_processing_service.py      # ê¸°ì¡´: ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í™•ì¥

# ì„¤ì • ì™¸ë¶€í™”
config/
â””â”€â”€ choi_algorithm.yml             # Î±, Î² ìƒìˆ˜ + KPI ì •ì˜
```

```python
# PEGProcessingServiceì— ë‹¨ê³„ ì¶”ê°€
self.processing_steps = [
    "data_retrieval",
    "data_validation", 
    "filtering",           # ì‹ ê·œ: 6ì¥ êµ¬í˜„
    "aggregation",
    "derived_calculation",
    "judgement",           # ì‹ ê·œ: 4ì¥, 5ì¥ êµ¬í˜„
    "result_formatting",
]
```

```plaintext
ì›ì‹œ ë°ì´í„° â†’ [ë°±ì—”ë“œ] â†’ íŒì • ê²°ê³¼ + ê·¼ê±° â†’ [MCP] â†’ ìì—°ì–´ ì„¤ëª… â†’ [í”„ë¡ íŠ¸] â†’ UI ë Œë”ë§
            í•„í„°ë§â†’ì§‘ê³„â†’íŒì •              í•´ì„ ìƒì„±              í‘œì‹œ+ìƒí˜¸ì‘ìš©
```

---

**User**

ë‚œ ì§€ê¸ˆ ì´ ì±„íŒ… ì„¸ì…˜ì„ ë°±ì—”ë“œ í´ë”ì—ì„œ ìœ ì§€í•˜ê³  ì‹¶ì–´. ì˜®ê¸°ëŠ” ë°©ë²•ìˆì–´? 

---

**Cursor**

í˜„ì¬ ì±„íŒ… ì„¸ì…˜ì„ `D:\Coding\kpi_dashboard\backend` í´ë”ë¡œ ì˜®ê¸°ëŠ” ë°©ë²•ì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

PowerShellì—ì„œëŠ” ë‹¤ë¥¸ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤:

---

**User**

PS D:\Coding\kpi_dashboard\backend> Get-Location

Path
----
D:\Coding\kpi_dashboard\backend


PS D:\Coding\kpi_dashboard\backend> 

---

**Cursor**

ì™„ë²½í•©ë‹ˆë‹¤! ğŸ‰ 

í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ê°€ `D:\Coding\kpi_dashboard\backend`ë¡œ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì´ ì±„íŒ… ì„¸ì…˜ì—ì„œ ì‹¤í–‰í•˜ëŠ” ëª¨ë“  í„°ë¯¸ë„ ëª…ë ¹ì–´ë“¤ì´ backend í´ë”ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë™ì‘í•  ê²ƒì…ë‹ˆë‹¤.

í˜„ì¬ `D:\Coding\kpi_dashboard\backend` í´ë”ì— ìˆì§€ë§Œ, ì‹¤ì œ íŒŒì¼ ëª©ë¡ì„ ë³´ë‹ˆ `3gpp_analysis_mcp` í”„ë¡œì íŠ¸ êµ¬ì¡°ê°€ ë³´ì…ë‹ˆë‹¤. 

ì´ì œ ì´ ë°±ì—”ë“œ í™˜ê²½ì—ì„œ **Choi ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„**ì„ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ì•ì„œ ë¶„ì„í•œ ëŒ€ë¡œ:

- **`analysis_llm/services/`** í´ë”ì— `choi_filtering_service.py`, `choi_judgement_service.py` ì¶”ê°€
- **`analysis_llm/config/`** í´ë”ì— `choi_algorithm.yml` ì„¤ì • íŒŒì¼ ì¶”ê°€  
- **`analysis_llm/models/`** í´ë”ì— `judgement.py` ë„ë©”ì¸ ëª¨ë¸ ì¶”ê°€

í•„ìš”í•˜ì‹œë©´ ì§€ê¸ˆë¶€í„° ì‹¤ì œ êµ¬í˜„ì„ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤. ì–´ë–¤ ë¶€ë¶„ë¶€í„° ì‹œì‘í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?

1. **ì„¤ì • íŒŒì¼** (`choi_algorithm.yml`) ë¶€í„°?
2. **ë„ë©”ì¸ ëª¨ë¸** (`judgement.py`) ë¶€í„°?
3. **í•„í„°ë§ ì„œë¹„ìŠ¤** (6ì¥) ë¶€í„°?
4. **íŒì • ì„œë¹„ìŠ¤** (4ì¥, 5ì¥) ë¶€í„°?

